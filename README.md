## 基础功能
所有角色用户登录操作  
学生默认账号密码均为学号  
为保证安全，登录时检测到账号密码相同会要求修改密码，可忽略  
加密用户角色，基于解密的角色完成用户独有操作
密码加密保存
## 选导师
### 学生
未到开始时间无法选择  
开始后未选择，选择数量未满的指导教师  
开始后已选择，选择后不可更改；禁止已选学生改选
### 教师
查看已选自己学生；查看所有未选/已选学生情况；导出信息excel表格  
作为评审老师对学生各个阶段评分
### 管理员
独立角色，无教师操作权限  
设置开始时间；导入学生表格，导入教师表格(姓名/账号/数量/分组等)；重置密码等
### 实现
未开始加载教师信息(带学生数量)但不可选择提交；  
学生不存在，token中解密出因此必然存在无需再次判断； 教师不存在，在更新时已基于ID查询不存在无法更新，但无法提供精确反馈信息，鉴于此场景属极端情况可忽略。  
并发下教师数量已满，返回新的教师信息列表，减少前端网络请求；  
提交成功后返回指导教师信息，不再加载选择列表减少数据请求；
## 分组/排序
选导师后将学生分组。原则，学生与指导教师不在同组。  
需提前确定教师分组(导入教师时包含组，无指导学生教师也添加，带学生数为0)。前端完成，直接乱序生成组内顺序。
### 实现
直接前端实现分组。遍历指导教师下学生，插入到其他组随机位置实现排序，动态显示结果，提交后端保存；
## 评分
毕业设计包含若干过程(开题答辩/期中检查/毕业答辩/演示)，过程100分按比例包含若干打分项；不同过程由学生所在组评审或指导教师打分。  
过程/项/比例等均为动态添加。
### 实现
过程不支持打分，过程至少包含一个打分项；  
前端判断项分数之和为100；  
打分粒度为过程整体而非项，授权给组内评审或指导教师，加载指定过程时按类型加载对应学生，组学生或指导学生；  

过程包含的项以json数组保存，通过每项中的number区分不基于ID。  
教师对学生过程的评分项以json数组保存。
## 过程文档管理
学生上传电子版开题/毕设报告，评审浏览评分
## Technologies
OpenJDK ^17  
springboot ^3.2.2  
spring-data-r2dbc  
spring-webflux  
NIO文件操作  
MySQL 8.3.0  
使用spring-cache缓存过程/分组学生等  
采用SQL/NoSQL混合开发模式  

本来打算使用redis进行缓存，但是该系统需要缓存的功能较少且粗糙，spring-cache更简便
## WebFlux
1. 并行操作数据库时，如果一个表的数据引用于另一个表，则被引用的表必须先阻塞完成操作，否则异步编程会多开线程随机执行，造成错误
2. 响应式编程的精髓：操作的对象必须放入流中，否则白干。
3. r2dbc搜索list集合最好还是用Flux，在service层转为list，不然出现奇怪的错误。
4. @RequiredArgsConstructor和@Autowire除了表示形式不一样，功能效果一模一样。
## update 2024.01.23
学生可查看各个阶段详细分数  
如果所有阶段评分完成，学生可查看最终得分
